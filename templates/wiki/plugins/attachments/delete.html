{% extends "wiki/article.html" %}
{% load wiki_tags i18n humanize %}


{% block wiki_pagetitle %}{% trans "Delete" %} "{{ attachment.current_revision.get_filename }}"{% endblock %}

{% block wiki_contents_tab %}

{% if attachment.article == article %}
<h2 class="title is-3">{% trans "Delete" %} "{{ attachment.current_revision.get_filename }}"?</h2>
  <div class="content">
    <p>
      {% trans "The file may be referenced on other articles. Deleting it means that they will loose their references to this file. The following articles reference this file:" %}
    </p>
    <ul>
      {% for a in attachment.articles.all %}
        <li class="is-size-5">{{ a.current_revision.title }}</li>
      {% endfor %}
    </ul>
  </div>
<hr />
<form method="POST" id="attachment_form" enctype="multipart/form-data">
  {% wiki_form form %}
  <div class="field is-grouped">
    <div class="control">
      <a href="{% url 'wiki:attachments_index' path=urlpath.path article_id=article.id %}" class="button is-rounded">
        <span class="icon">
          <i class="fa fa-arrow-left"></i>
        </span>
        <span>{% trans "Go back" %}</span>
      </a>
    </div>
    <div class="control">
      <button class="button is-rounded is-danger">
        <span class="icon">
          <i class="fa fa-remove"></i>
        </span>
        <span>{% trans "Delete it!" %}</span>
      </button>
    </div>
  </div>
</form>

{% else %}
  <h2 class="title is-3">{% trans "Remove" %} "{{ attachment.current_revision.get_filename }}"?</h2>
  <div class="content">
    <p>
      {% blocktrans with attachment.original_filename as filename trimmed %}
      You can remove a reference to a file, but it will retain its references on other articles.
      {% endblocktrans %}
    </p>
  </div>
  <form method="POST" id="attachment_form" enctype="multipart/form-data">
  {% wiki_form form %}
  <div class="field is-grouped">
    <div class="control">
      <a href="{% url 'wiki:attachments_index' path=urlpath.path article_id=article.id %}" class="button is-rounded">
        <span class="icon">
          <i class="fa fa-arrow-left"></i>
        </span>
        <span>{% trans "Go back" %}</span>
      </a>
    </div>
    <div class="control">
      <button class="button is-rounded is-danger">
        <span class="icon">
          <i class="fa fa-remove"></i>
        </span>
        <span>{% trans "Remove reference" %}</span>
      </button>
    </div>
  </div>
</form>

{% endif %}

{% endblock %}
